// Get the latest version: https://github.com/nparshook/openrct2-queue-assist
!(function(){'use strict';var t=function(t){return'footpath'==t.type&&t.isQueue},i=(function(){function i(){var i=this;this.current_highlight=null,this.queues={};for(var e=function(t){var e=null===t.ride?-1:t.ride;e in i.queues||(i.queues[e]=[]),i.queues[e].push(t)},n=0;n<map.size.x;n++)for(var u=0;u<map.size.y;u++)map.getTile(n,u).elements.filter(t).map(e)}return Object.defineProperty(i.prototype,'currentSurface',{get:function(){return null===this.current_highlight||-1==this.current_highlight?null:this.queues[this.current_highlight][0].surfaceObject},set:function(t){null!==t&&null!==this.current_highlight&&-1!=this.current_highlight&&this.currentSurface!=t&&this.queues[this.current_highlight].forEach((function(i){return i.surfaceObject=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,'currentRailings',{get:function(){return null===this.current_highlight||-1==this.current_highlight?null:this.queues[this.current_highlight][0].railingsObject},set:function(t){null!==t&&null!==this.current_highlight&&-1!=this.current_highlight&&this.currentRailings!=t&&this.queues[this.current_highlight].forEach((function(i){return i.railingsObject=t}))},enumerable:!1,configurable:!0}),i.prototype.highlight_orphans=function(){this.toggle_ride_highlight(-1)},i.prototype.unhighlight=function(){null!==this.current_highlight&&this.queues[this.current_highlight].map((function(t){return t.isGhost=!1})),this.current_highlight=null},i.prototype.toggle_ride_highlight=function(t){this.unhighlight(),t in this.queues&&(this.queues[t].map((function(t){return t.isGhost=!0})),this.current_highlight=t)},i.prototype.has_highlight=function(){return null!==this.current_highlight},i.prototype.toggle_visibility=function(){null!==this.current_highlight&&this.queues[this.current_highlight].map((function(t){return t.isHidden=!t.isHidden}))},i})(),e=''.concat('0.2').concat('').concat('production'),n='undefined'!=typeof ui,u=function(t){return t.map((function(t){return t.name}))},s='queue.assist.main.window',h='Queue Assist (v'.concat(e,')'),r=210,o=20,c='queue.assist.ride.selection',l='queue.assist.ride.checkbox',a='queue.assist.orphan.checkbox',f='queue.assist.queue.visibility.toggle',g='queue.assist.queue.surface.selection',d='queue.assist.queue.railing.selection',b='queue.assist.queue.style.label',p='queue.assist.queue.style.apply',v=(function(){function t(){var t=this;this.uiWindow=null,this.rideDropdownHeadline=['Select a ride'],this.surfaceDropdownHeadline=['Select a surface style'],this.railingDropdownHeadline=['Select a railing style'],this.manager=new i,this.rides=map.rides.filter((function(t){return'ride'==t.classification})),this.rideNames=this.rides.map((function(t){return t.name})),this.surfaces=context.getAllObjects('footpath_surface'),this.railings=context.getAllObjects('footpath_railings'),this.surfaceIdToIdx={},this.surfaceIdxToId={},this.surfaces.forEach((function(i,e){t.surfaceIdToIdx[i.index]=e,t.surfaceIdxToId[e]=i.index})),this.railingsIdToIdx={},this.railingsIdxToId={},this.railings.forEach((function(i,e){t.railingsIdToIdx[i.index]=e,t.railingsIdxToId[e]=i.index}))}return t.prototype.open=function(){var t=ui.getWindow(s);t&&t.close(),this.uiWindow=ui.openWindow(this.constructWindow()),this.rideDropdownContent=this.rideNames,this.surfaceDropdownContent=u(this.surfaces),this.railingDropdownContent=u(this.railings),this.disable_style_editor(!0)},t.prototype.getWidgetById=function(t){var i;return null===(i=this.uiWindow)||void 0===i?void 0:i.findWidget(t)},Object.defineProperty(t.prototype,'rideSelectionWidget',{get:function(){return this.getWidgetById(c)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'rideCheckboxWidget',{get:function(){return this.getWidgetById(l)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'orphanCheckboxWidget',{get:function(){return this.getWidgetById(a)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'queueVisibilityToggle',{get:function(){return this.getWidgetById(f)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'surfaceSelectionWidget',{get:function(){return this.getWidgetById(g)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'railingSelectionWidget',{get:function(){return this.getWidgetById(d)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'queueStyleLabelWidget',{get:function(){return this.getWidgetById(b)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'queueStyleApplyWidget',{get:function(){return this.getWidgetById(p)},enumerable:!1,configurable:!0}),t.prototype.setDropDownContent=function(t,i,e){t.items=i.concat(e)},Object.defineProperty(t.prototype,'rideDropdownContent',{set:function(t){this.setDropDownContent(this.rideSelectionWidget,this.rideDropdownHeadline,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'surfaceDropdownContent',{set:function(t){this.setDropDownContent(this.surfaceSelectionWidget,this.surfaceDropdownHeadline,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,'railingDropdownContent',{set:function(t){this.setDropDownContent(this.railingSelectionWidget,this.railingDropdownHeadline,t)},enumerable:!1,configurable:!0}),t.prototype.constructRideCheckbox=function(){var t=this;return{name:l,type:'checkbox',isChecked:!0,width:10,height:20,x:5,y:20,onChange:function(){return t.ride_checkbox_change()}}},t.prototype.constructOrphanCheckbox=function(){var t=this;return{name:a,type:'checkbox',text:'Orphans',isChecked:!1,width:10,height:o,x:5,y:40,onChange:function(){return t.orphan_checkbox_change()}}},t.prototype.constructRideDropdown=function(){var t=this;return{name:c,type:'dropdown',width:r,height:o,x:20,y:20,items:this.rideDropdownHeadline,selectedIndex:0,onChange:function(i){return t.select_ride_queue(i-1)}}},t.prototype.constructVisibilityToggle=function(){var t=this;return{name:f,type:'button',text:'Toggle Queue Visibility',width:r,height:o,x:20,y:60,onClick:function(){return t.manager.toggle_visibility()}}},t.prototype.constructStyleLabel=function(){return{name:b,type:'label',text:'Queue Style Editor',width:r,height:o,x:5,y:90}},t.prototype.constructSurfaceDropdown=function(){var t=this;return{name:g,type:'dropdown',width:r,height:o,x:20,y:110,items:this.surfaceDropdownHeadline,selectedIndex:0,onChange:function(i){return t.queue_style_dropdown_change(i)}}},t.prototype.constructRailingsDropdown=function(){var t=this;return{name:d,type:'dropdown',width:r,height:o,x:20,y:140,items:this.railingDropdownHeadline,selectedIndex:0,onChange:function(i){return t.queue_style_dropdown_change(i)}}},t.prototype.constructStyleApplyBtn=function(){var t=this;return{name:p,type:'button',text:'Apply Queue Style',width:r,height:o,x:20,y:170,onClick:function(){return t.update_queue_style()}}},t.prototype.constructWindow=function(){var t=this;return{classification:s,width:250,height:200,title:h,onClose:function(){return t.manager.unhighlight()},widgets:[this.constructRideCheckbox(),this.constructRideDropdown(),this.constructOrphanCheckbox(),this.constructVisibilityToggle(),this.constructStyleLabel(),this.constructSurfaceDropdown(),this.constructRailingsDropdown(),this.constructStyleApplyBtn()]}},t.prototype.ride_checkbox_change=function(){var t;if(!this.rideCheckboxWidget.isChecked)return this.manager.unhighlight(),this.queueVisibilityToggle.isDisabled=!0,void this.disable_style_editor(!0);this.queueVisibilityToggle.isDisabled=!1,this.rideSelectionWidget.isDisabled=!1,this.orphanCheckboxWidget.isChecked=!1,this.disable_style_editor(!1);var i=((null===(t=this.rideSelectionWidget)||void 0===t?void 0:t.selectedIndex)||0)-1;this.select_ride_queue(i)},t.prototype.orphan_checkbox_change=function(){if(!this.orphanCheckboxWidget.isChecked)return this.manager.unhighlight(),void(this.queueVisibilityToggle.isDisabled=!0);this.queueVisibilityToggle.isDisabled=!1,this.rideCheckboxWidget.isChecked=!1,this.rideSelectionWidget.isDisabled=!0,this.disable_style_editor(!0),this.manager.highlight_orphans()},t.prototype.disable_style_editor=function(t){this.queueStyleLabelWidget.isDisabled=t,this.queueStyleApplyWidget.isDisabled=t,this.surfaceSelectionWidget.isDisabled=t,this.railingSelectionWidget.isDisabled=t},t.prototype.select_ride_queue=function(t){if(t<0)this.manager.unhighlight(),this.disable_style_editor(!0),this.surfaceSelectionWidget.selectedIndex=0,this.railingSelectionWidget.selectedIndex=0;else{this.manager.toggle_ride_highlight(this.rides[t].id),this.disable_style_editor(!1);var i=this.manager.currentSurface,e=this.manager.currentRailings;if(null===i||null===e)return;this.surfaceSelectionWidget.selectedIndex=this.surfaceIdToIdx[i]+1,this.railingSelectionWidget.selectedIndex=this.railingsIdToIdx[e]+1}},t.prototype.queue_style_dropdown_change=function(t){(t-=1)<0?this.queueStyleApplyWidget.isDisabled=!0:this.queueStyleApplyWidget.isDisabled=!1},t.prototype.update_queue_style=function(){var t,i,e=((null===(t=this.surfaceSelectionWidget)||void 0===t?void 0:t.selectedIndex)||0)-1,n=((null===(i=this.railingSelectionWidget)||void 0===i?void 0:i.selectedIndex)||0)-1;e<0||n<0||(this.manager.currentSurface=this.surfaceIdxToId[e],this.manager.currentRailings=this.railingsIdxToId[n])},t})();registerPlugin({name:'openrct2-queue-assist',version:e,authors:['nparshook'],type:'local',licence:'MIT',main:function(){n&&'none'==network.mode&&ui.registerMenuItem('Queue Assist',(function(){(new v).open()}))}})})();
